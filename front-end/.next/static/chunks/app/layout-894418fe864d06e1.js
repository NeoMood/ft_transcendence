(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8017:function(e,t,n){Promise.resolve().then(n.bind(n,5828)),Promise.resolve().then(n.t.bind(n,7977,23)),Promise.resolve().then(n.t.bind(n,7402,23))},5828:function(e,t,n){"use strict";n.r(t),n.d(t,{contextdata:function(){return i}});var r=n(9268),a=n(6006),o=n(8792),l=n(6008),s=n(5795),c=n(6323);let u=null,i=(0,a.createContext)({});t.default=e=>{let{children:t}=e,n=(0,l.useRouter)(),[f,h]=(0,a.useState)(null),[d,g]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[y,_]=(0,a.useState)([]),[v,S]=(0,a.useState)(null),[k,w]=(0,a.useState)([]),[C,Z]=(0,a.useState)([]),[b,E]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=async()=>{try{let e=await s.Z.get("http://localhost:3000/api/user/userinfo");if(null===e.data){console.log("get : user "),(0,o.e8)("Token"),n.push("/login");return}console.log("resp.data ",e.data),h(e.data)}catch(e){console.log("error : ",e),(0,o.e8)("Token"),n.push("/login");return}};return e(),()=>{h(null)}},[b]),(0,a.useEffect)(()=>{if(f&&void 0!==f)return(u=(0,c.ZP)("http://localhost:3000",{extraHeaders:{Authorization:"Bearer ".concat((0,o.le)("Token"))}}))&&S(u),()=>u.disconnect()},[f]),(0,a.useEffect)(()=>{if(f&&void 0!==f)return console.log("useEffect user : ",f),async function(){console.log("getChannels user : ",f);try{let e=await s.Z.get("http://localhost:3000/api/chat/channels");if(null===e.data)return;Z(e.data)}catch(e){console.log("error : profiles ",e);return}}(),e(),t(),n(),r(),()=>{g([]),m([]),_([]),w([]),Z([])};async function e(){try{let e=await s.Z.get("http://localhost:3000/api/user/all");if(null===e.data)return;g(e.data)}catch(e){console.log("error : users ",e);return}}async function t(){try{let e=await s.Z.get("http://localhost:3000/api/user/profiles");if(null===e.data)return;m(e.data)}catch(e){console.log("error : profiles ",e);return}}async function n(){try{let e=await s.Z.get("http://localhost:3000/api/chat/messages/".concat(null==f?void 0:f.id));if(null===e.data)return;e.data.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),_(e.data)}catch(e){console.log("error : profiles ",e);return}}async function r(){console.log("getChannels user : ",f);try{let e=await s.Z.get("http://localhost:3000/api/chat/myChannels/".concat(null==f?void 0:f.id));if(null===e.data)return;w(e.data)}catch(e){console.log("error : profiles ",e);return}}},[f]),(0,r.jsx)(i.Provider,{value:{socket:v,user:f,users:d,profiles:p,messages:y,myChannels:k,channels:C,setChannels:Z,setUser:h,setMyChannels:w,setUsers:g,setProfiles:m,setMessages:_,setLoged:E,loged:b},children:t})}},5795:function(e,t,n){"use strict";var r=n(4214),a=n(8792);let o=r.Z.create({baseURL:"http://localhost:3000/api/"});o.interceptors.request.use(e=>{let t=(0,a.le)("Token");return t&&(e.headers={...e.headers,Authorization:"Bearer ".concat(t)}),e},e=>Promise.reject(e)),t.Z=o},8792:function(e,t,n){"use strict";n.d(t,{D$:function(){return r},e8:function(){return o},le:function(){return a}});let r=(e,t)=>{localStorage.setItem(e,t)},a=e=>{let t=localStorage.getItem(e);return t},o=e=>{localStorage.removeItem(e)}},7402:function(){},7977:function(e){e.exports={style:{fontFamily:"'__Inter_0ec1f4', '__Inter_Fallback_0ec1f4'",fontStyle:"normal"},className:"__className_0ec1f4"}}},function(e){e.O(0,[15,323,611,253,769,744],function(){return e(e.s=8017)}),_N_E=e.O()}]);